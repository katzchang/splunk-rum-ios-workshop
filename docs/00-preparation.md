# 準備

**所要時間:** 約15分

このセクションでは、ワークショップを進めるための環境確認とサンプルアプリのセットアップを行います。

---

## 1. Splunk Observability Cloud へのアクセス確認

### 1.1 ログイン

1. ブラウザで [https://app.jp0.signalfx.com/](https://app.jp0.signalfx.com/) にアクセス
2. 提供された認証情報でログイン
3. ダッシュボードが表示されることを確認

### 1.2 RUM画面の確認

1. 左側メニューから **RUM** を選択
2. RUM Overview 画面が表示されることを確認

> **Note:** この時点ではまだデータは表示されません。ワークショップを進めるとデータが表示されるようになります。

---

## 2. 開発環境の確認

### 2.1 必要なツール

以下のツールがインストールされていることを確認してください。

| ツール | 確認コマンド | 必要バージョン |
|--------|-------------|---------------|
| Xcode | `xcodebuild -version` | 15.0 以上 |
| Node.js | `node -v` | 18.0 以上 |
| npm | `npm -v` | 9.0 以上 |

**インストールガイド:**

- **Xcode**: [Mac App Store](https://apps.apple.com/app/xcode/id497799835) からインストール
- **Node.js / npm**: [Node.js 公式サイト](https://nodejs.org/) から LTS 版をインストール（npm は Node.js に含まれています）

### 2.2 iOS シミュレーターの確認

1. Xcode を起動
2. メニューから **Window** → **Devices and Simulators** を選択
3. **Simulators** タブで任意の iPhone シミュレーターが利用可能であることを確認

---

## 3. サンプルアプリのセットアップ

### 3.1 リポジトリのクローン

```bash
git clone <リポジトリURL>
cd splunk-rum-ios-workshop
```

### 3.2 Angular アプリと API サーバーの起動

WebView で表示する商品一覧アプリと、RUM テスト用の API サーバーを起動します。

**ターミナル 1: Angular アプリ（WebView 用）**
```bash
cd angular-app
npm install
npm start
```

ブラウザで http://localhost:4200 にアクセスし、商品一覧が表示されることを確認してください。

**ターミナル 2: API サーバー（HTTP ステータスコードテスト用）**
```bash
cd angular-app
npm run serve
```

API サーバーが http://localhost:3000 で起動します。

> **Note:** 両方のサーバーをワークショップ中ずっと起動しておく必要があります。

### 3.3 iOS アプリのビルド

新しいターミナルウィンドウを開き、以下を実行します。

```bash
cd SampleApp
open RUMSampleApp.xcodeproj
```

Xcode が開いたら：

1. 上部のデバイス選択で任意の **iPhone シミュレーター** を選択
2. **Cmd + R** でビルド＆実行
3. シミュレーターでアプリが起動することを確認

---

## 4. アプリの動作確認

サンプルアプリの各機能が正常に動作することを確認します。

### 4.1 ログイン画面

1. アプリ起動後、ログイン画面が表示される
2. 「ログイン」ボタンをタップ
3. シミュレーターでは Face ID が利用できないため、スキップしてホーム画面に遷移

### 4.2 ホーム画面

ホーム画面で以下の4つのボタンが表示されることを確認：

- **カメラを起動** - カメラ画面を開く
- **商品一覧を見る** - WebView で Angular アプリを表示
- **RUM テスト** - RUM 機能のテスト画面を開く
- **ログアウト** - ログイン画面に戻る

### 4.3 カメラ画面

1. 「カメラを起動」をタップ
2. カメラ権限のダイアログが表示されたら「OK」を選択
3. シミュレーターではカメラは動作しませんが、画面が表示されることを確認
4. 戻るボタンでホーム画面に戻る

### 4.4 WebView 画面（商品一覧）

1. 「商品一覧を見る」をタップ
2. Angular アプリの商品一覧が WebView 内に表示される
3. 商品をタップして詳細画面に遷移することを確認
4. 「← 戻る」で一覧に戻れることを確認

### 4.5 RUM テスト画面

1. 「RUM テスト」をタップ
2. 以下のボタンが表示されることを確認：
   - **クラッシュさせる** - アプリをクラッシュさせる（RUM でクラッシュレポートを確認）
   - **ログを出力** - NSLog でログを出力
   - **200 OK / 400 Bad Request / 500 Server Error** - HTTP リクエストのテスト
   - **商品一覧 (API)** - Angular サーバーの API にリクエスト
3. 「200 OK」をタップし、レスポンスが受信されることを確認

---

## 5. 確認チェックリスト

次のセクションに進む前に、以下を確認してください。

- [ ] Splunk Observability Cloud にログインできる
- [ ] Angular アプリが http://localhost:4200 で起動している
- [ ] iOS アプリがシミュレーターで動作する
- [ ] ログイン → ホーム → カメラ / WebView の画面遷移ができる

すべて確認できたら、次のセクション「自動計装」に進みましょう。

---

**次のセクション:** [自動計装](./01-auto-instrumentation.md)
